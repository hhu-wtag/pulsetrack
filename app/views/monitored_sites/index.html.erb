<div class="container mx-auto py-8 px-4">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold">My Monitored Sites</h1>
    <%= link_to "Add New Site", new_monitored_site_path, class: "btn btn-primary" %>
  </div>

  <%= turbo_frame_tag "monitored_sites_list" do %>
    <% if @monitored_sites.any? %>
      <div class="overflow-x-auto">
        <table class="table w-full">
          <thead>
          <tr>
            <th>Status</th>
            <th>Site Name</th>
            <th>URL</th>
            <th>Last Checked</th>
            <th></th>
          </tr>
          </thead>
          <tbody>
          <% @monitored_sites.each do |site| %>
            <%= tag.tr id: dom_id(site) do %>
              <td>
                <% if site.up? %>
                  <span class="badge badge-success">Up</span>
                <% elsif site.down? %>
                  <span class="badge badge-error">Down</span>
                <% else %>
                  <span class="badge badge-ghost">Pending</span>
                <% end %>
              </td>
              <td><%= site.name %></td>
              <td><%= link_to site.url, site.url, target: "_blank", class: "link" %></td>
              <td><%= time_ago_in_words(site.check_results.last&.created_at || site.updated_at) %> ago</td>
              <td>
                <div class="flex items-center">
                  <%= link_to "Details", site, class: "btn btn-ghost btn-sm", data: { turbo_frame: "_top" } %>

                  <%= tag.button "Remove",
                                 class: "btn btn-ghost btn-sm text-error",
                                 data: {
                                   action: "click->confirm#open",
                                   confirm_title_param: "Delete #{site.name}?",
                                   confirm_message_param: "Are you sure you want to delete this site?",
                                   confirm_button_text_param: "Yes, Delete",
                                   confirm_url_param: monitored_site_path(site)
                                 }
                  %>
                </div>
              </td>
            <% end %>
          <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <div class="text-center py-12">
        <h2 class="text-xl font-semibold">You're not monitoring any sites yet.</h2>
        <p class="mb-4">Click the button below to get started!</p>
        <%= link_to "Add Your First Site", new_monitored_site_path, class: "btn btn-primary" %>
      </div>
    <% end %>
  <% end %>
</div>