<main class="bg-slate-950 text-slate-200 h-screen flex flex-col w-full">
  <%= turbo_stream_from "monitoring_dashboard" %>
  <header class="p-4 bg-slate-900 border-b border-slate-800 flex-shrink-0">
    <div class="flex gap-4 w-full">
      <div class="flex-1 bg-slate-800 p-4 rounded border border-slate-700">
        <p class="text-xs text-slate-400 uppercase tracking-wider font-bold">Total Up</p>
        <p class="text-2xl font-mono text-emerald-400"><%= @sites_count.fetch('up', 0) %></p>
      </div>
      <div class="flex-1 bg-slate-800 p-4 rounded border border-slate-700">
        <p class="text-xs text-slate-400 uppercase tracking-wider font-bold">Total Down</p>
        <p class="text-2xl font-mono text-rose-500"><%= @sites_count.fetch('down', 0) %></p>
      </div>
      <div class="flex-1 bg-slate-800 p-4 rounded border border-slate-700">
        <p class="text-xs text-slate-400 uppercase tracking-wider font-bold">Maintenance</p>
        <p class="text-2xl font-mono text-amber-500"><%= @sites_count.fetch('maintenance', 0) %></p>
      </div>
    </div>
  </header>

  <main class="flex flex-1 overflow-hidden">
    <aside class="w-[30%] bg-slate-900 border-r border-slate-800 flex flex-col">
      <div class="p-4 border-b border-slate-800 bg-slate-900/50 sticky top-0">
        <h2 class="font-bold text-slate-400 text-sm uppercase">Monitored Sites</h2>
      </div>
      <div class="flex-1 overflow-y-auto">
        <ul class="divide-y divide-slate-800">
          <% @monitored_sites.each do |site| %>
            <% theme = status_style(site.last_status) %>
            <li id="<%= dom_id(site, 'site') %>"
                class="p-4 hover:bg-slate-800 transition-colors cursor-pointer border-0 border-l-4 <%= 'border-' + theme[:base] %>">
              <%= link_to site do %>
                <p class="font-medium"><%= site.name %></p>
                <p class="text-xs text-slate-500"><%= site.url %></p>
              <% end %>
            </li>
          <% end %>
        </ul>
      </div>
    </aside>

    <section class="w-[70%] bg-slate-950 flex flex-col">
      <div class="p-4 border-b border-slate-800 bg-slate-900/50 sticky top-0">
        <h2 class="font-bold text-slate-400 text-sm uppercase">Live Status Feed</h2>
      </div>
      <div class="flex-1 overflow-y-auto p-4">
        <div id="global_live_feed" class="space-y-2">

          <%= render partial: "check_results/check_result_live_feed", collection: @recent_results, as: :check_result %>

          <div class="flex items-center justify-between p-3 bg-slate-900 rounded border border-slate-800">
            <div class="flex items-center gap-3">
              <span class="w-2 h-2 rounded-full bg-emerald-500"></span>
              <span class="text-sm font-mono text-slate-400">17:14:58</span>
              <span class="text-sm">Auth Microservice: Connected</span>
            </div>
            <span class="text-xs text-slate-500 font-mono">112ms</span>
          </div>

          <div class="flex items-center justify-between p-3 bg-rose-950/20 rounded border border-rose-900/50">
            <div class="flex items-center gap-3">
              <span class="w-2 h-2 rounded-full bg-rose-500 animate-pulse"></span>
              <span class="text-sm font-mono text-rose-400">17:14:45</span>
              <span class="text-sm text-rose-200 font-bold">Legacy Database Proxy: Connection Timeout</span>
            </div>
            <span class="text-xs text-rose-500 font-mono">ERR</span>
          </div>

        </div>
      </div>
    </section>

  </main>
</main>